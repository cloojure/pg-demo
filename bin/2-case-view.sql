Create MATERIALIZED   VIEW  CASE_MASTER as
    SELECT
        CM.CASE_ID, CM.GLOBAL_NUM, CM.INITIAL_JUSTIFICATION, CM.WORKFLOW_SEQ_NUM,
        CM.OWNER_ID, CM.SITE_ID, CM.SUSAR, CM.CLOSE_USER_ID, CM.CLOSE_DATE,
        CM.DATE_LOCKED, CM.CLOSE_NOTES, CM.STATE_ID, CM.LAST_STATE_ID,
        CM.REQUIRES_FOLLOWUP, CM.DUE_SOON, CM.CREATE_TIME, CM.FOLLOWUP_DATE,
        CM.INIT_REPT_DATE, CM.LAST_UPDATE_TIME, CM.SAFETY_DATE, CM.WORKLIST_OWNER_ID,
        CM.CASE_NUM, CM.E2B_WW_NUMBER, CM.COUNTRY_ID, CM.RPT_TYPE_ID, CM.USER_ID,
        CM.LAST_UPDATE_USER_ID, CM.SERIOUSNESS, cvt.VERSION_NUM, cvt.EFFECTIVE_START_DATE,
        cvt.EFFECTIVE_END_DATE, CM.ENTERPRISE_ID
	FROM
		RM_CASE_MASTER AS CM, CASE_VERSION_TABLE AS cvt
	WHERE
		(cvt.CASE_ID = CM.CASE_ID) AND (cvt.EFFECTIVE_START_DATE >= CM.EFFECTIVE_START_DATE) AND
        (cvt.EFFECTIVE_START_DATE < CM.EFFECTIVE_END_DATE) AND (CM.DELETED_FLAG = 0) AND
        (CM.ENTERPRISE_ID = cvt.ENTERPRISE_ID);


CREATE  MATERIALIZED   VIEW  CASE_PRODUCT as SELECT A.*, B.VERSION_NUM 
    FROM RM_CASE_PRODUCT A , CASE_VERSION_TABLE B 
    WHERE   A.CASE_ID = B.CASE_ID  AND 
            A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND 
            A.DELETED_FLAG = 0 AND 
            A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND 
            A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 


CREATE MATERIALIZED VIEW CASE_FOLLOWUP as SELECT A.*, B.VERSION_NUM FROM RM_CASE_FOLLOWUP A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_ASSESS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_ASSESS A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_PAT_INFO as SELECT A.*, B.VERSION_NUM FROM RM_CASE_PAT_INFO A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_STUDY as SELECT A.*, B.VERSION_NUM FROM RM_CASE_STUDY A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_EVENT as SELECT A.*, B.VERSION_NUM FROM RM_CASE_EVENT A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_DEATH as SELECT A.*, B.VERSION_NUM FROM RM_CASE_DEATH A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_DEATH_DETAILS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_DEATH_DETAILS A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_EVENT_ASSESS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_EVENT_ASSESS A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_PREGNANCY as SELECT A.*, B.VERSION_NUM FROM RM_CASE_PREGNANCY A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_REPORTERS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_REPORTERS A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_ACTIONS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_ACTIONS A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_CONTACT_LOG as SELECT A.*, B.VERSION_NUM FROM RM_CASE_CONTACT_LOG A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_DOSE_REGIMENS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_DOSE_REGIMENS A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_EVENT_CONSEQUENCE as SELECT A.*, B.VERSION_NUM FROM RM_CASE_EVENT_CONSEQUENCE A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_EVENT_DETAIL as SELECT A.*, B.VERSION_NUM FROM RM_CASE_EVENT_DETAIL A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_EVENT_NATURE as SELECT A.*, B.VERSION_NUM FROM RM_CASE_EVENT_NATURE A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_EVENT_PRODUCT_RPTBLTY as SELECT A.*, B.VERSION_NUM FROM RM_CASE_EVENT_PRODUCT_RPTBLTY A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_HOSP as SELECT A.*, B.VERSION_NUM FROM RM_CASE_HOSP A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_LAB_DATA as SELECT A.*, B.VERSION_NUM FROM RM_CASE_LAB_DATA A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_LITERATURE as SELECT A.*, B.VERSION_NUM FROM RM_CASE_LITERATURE A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_NEONATES as SELECT A.*, B.VERSION_NUM FROM RM_CASE_NEONATES A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_PARENT_INFO as SELECT A.*, B.VERSION_NUM FROM RM_CASE_PARENT_INFO A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_ROUTING as SELECT A.*, B.VERSION_NUM FROM RM_CASE_ROUTING A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_REFERENCE as SELECT A.*, B.VERSION_NUM FROM RM_CASE_REFERENCE A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_PROD_DRUGS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_PROD_DRUGS A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_EVENT_IMPUTABILITY as SELECT A.*, B.VERSION_NUM FROM RM_CASE_EVENT_IMPUTABILITY A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_COMPANY_CMTS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_COMPANY_CMTS A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_LOCAL_EVA_COMMENT as SELECT A.*, B.VERSION_NUM FROM RM_CASE_LOCAL_EVA_COMMENT A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_NARRATIVE as SELECT A.*, B.VERSION_NUM FROM RM_CASE_NARRATIVE A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_RELATIONSHIPS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_RELATIONSHIPS A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_PROD_INGREDIENT as SELECT A.*, B.VERSION_NUM FROM RM_CASE_PROD_INGREDIENT A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_PROD_INDICATIONS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_PROD_INDICATIONS A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_CLASSIFICATIONS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_CLASSIFICATIONS A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_MED_STATUS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_MED_STATUS A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_PAT_HIST as SELECT A.*, B.VERSION_NUM FROM RM_CASE_PAT_HIST A , CASE_VERSION_TABLE B WHERE A.CASE_ID = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
CREATE MATERIALIZED VIEW CASE_PAT_TESTS as SELECT A.*, B.VERSION_NUM FROM RM_CASE_PAT_TESTS A , CASE_VERSION_TABLE B WHERE A.rel_test_id = B.CASE_ID  AND A.ENTERPRISE_ID = B.ENTERPRISE_ID  AND A.DELETED_FLAG = 0 AND A.EFFECTIVE_START_DATE  <= B.EFFECTIVE_START_DATE AND A.EFFECTIVE_END_DATE > B.EFFECTIVE_START_DATE; 
